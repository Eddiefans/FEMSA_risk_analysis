Emisoras <- read.csv("Emisoras_Completo2.csv")
library(PerformanceAnalytics)
library(quantmod)
clave <- "FEMSAUBD.MX"
datos <- new.env()
getSymbols(clave, warnings = FALSE, env=datos)
precio <- datos[[clave]][,6]
Rend <- na.omit(diff(log(na.omit(precio))))
getSymbols("^MXX")
rend_mercado <- na.omit(diff(log(na.omit(MXX$MXX.Adjusted))))
datos <- na.omit(merge.xts(Rend, rend_mercado))
cor(datos)
cov(datos)
chart.Correlation(datos)
lista <- as.matrix(Emisoras)
n <- length(lista)
mat_cor_a <- matrix(nrow=n, ncol=2)
datos_cor <- new.env()
for (i in 1:n) {
clave <- lista[i]
getSymbols(clave, env=datos_cor, warnings = FALSE)
precio2 <- datos_cor[[clave]][,6]
rendimiento2 <- na.omit(diff(log(na.omit(precio2))))
datos_cor2 <- na.omit(merge.xts(Rend, rendimiento2))
ro <- as.numeric(cor(datos_cor2)[1,2])
mat_cor_a[i,2] <- ro
mat_cor_a[i,1] <- clave
}
library(tidyverse)
mat_cor_a <- as.data.frame(mat_cor_a)
names(mat_cor_a) <- c("Activo", "Ro")
arrange(mat_cor_a, Ro)
